!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var App=Backbone.Model.extend({defaults:{state:"start"}}),app=new App,AppView=Backbone.View.extend({model:app,id:"app",screens:[],initialize:function(){this.render(),this.model.on("change:state",this.changeScreens,this),this.createScreen()},render:function(){$("body").prepend(this.$el)},events:{"transitionend .screen-oldScreen, oTransitionEnd .screen-oldScreen, webkitTransitionEnd .screen-oldScreen":function(){this.screens[0].unbind(),this.screens[0].remove(),this.screens.shift();var a=this.afterScreenTransitionCalls[this.model.get("state")+"AfterCall"];"function"==typeof a&&a(),$(".screen-newScreen").removeClass("screen-newScreen"),$("body").removeClass("is-screenTransition is-screenReverseTransition")},"click .back":function(a){a.preventDefault(),$("body").addClass("is-screenReverseTransition"),history.back()}},createScreen:function(){var a=new ScreenView;0<this.screens.length&&a.$el.addClass("screen-newScreen"),this.screens.push(a),this.$el.append(a.$el)},changeScreens:function(){this.createScreen();var a=this.beforeScreenTransitionCalls[this.model.get("state")+"BeforeCall"];"function"==typeof a&&a(),this.screens[0].$el.addClass("screen-oldScreen"),setTimeout(function(){$("body").addClass("is-screenTransition")},10)},beforeScreenTransitionCalls:{},afterScreenTransitionCalls:{}}),appView;$(document).ready(function(){appView=new AppView});var ScreenView=Backbone.View.extend({tagName:"section",className:"screen",templates:{start:_.template($("#start").html())},initialize:function(){this.render()},render:function(){this.$el.html(this.templates[app.get("state")])}}),Router=Backbone.Router.extend({routes:{"":"start"},start:function(){app.set("state","start")}}),router=new Router;Backbone.history.start();